{% extends 'core/base.html' %}
{% load static %}

{% block title %}Dieta{% endblock %}
{% block links %}
  <link href="{% static '/lib/select2-4.0.13/css/select2.css' %}" rel="stylesheet"/>
  <link href="{% static '/lib/select2-4.0.13/css/select2-bootstrap4.min.css' %}" rel="stylesheet"/>
  <script src="{% static '/lib/select2-4.0.13/js/select2.js' %}"></script>
  
{% endblock %}
{% block content %}
<strong>Dieta</strong>
<main role="main">
    <div class="container">
        <div class="row mt-3">
            <div class="col-md-12 mx-auto mb-5">
                <form action="" method="post">{% csrf_token %}
                <h3 class="mb-4">Dieta</h3>
                {{ form.errors }}
                 
                <div class="row">
                    <div class="col-md-3">
                        <p>
                            <label>Verduras:</label>
                            <input type="number" name="vegetables" id="id_vegetables" class="form-control" min="0" value="0">
                        </p>
                    </div>
                    <div class="col-md-3">
                        <p>
                            <label>Frutas:</label>
                            <input type="number" name="fruits" id="id_fruits" class="form-control" min="0" value="0">
                        </p>
                    </div>
                    <div class="col-md-3">
                        <p>
                            <label>Leche descremada:</label>
                            <input type="number" name="skim_milk" id="id_skim_milk" class="form-control" min="0" value="0">
                        </p>
                    </div>
                    <div class="col-md-3">
                        <p>
                            <label>Leche semidescremada:</label>
                            <input type="number" name="low_fat_milk" id="id_low_fat_milk" class="form-control" min="0" value="0">
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3">
                        <p>
                            <label>Cereales y Tuberculos (s/g):</label>
                            <input type="number" name="cereals_and_tubers_s" id="id_cereals_and_tubers_s" class="form-control" min="0" value="0">
                        </p>
                    </div>
                    <div class="col-md-3">
                        <p>
                            <label>Cereales y Tuberculos (c/g):</label>
                            <input type="number" name="cereals_and_tubers_c" id="id_cereals_and_tubers_c" class="form-control" min="0" value="0">
                        </p>
                    </div>
                    <div class="col-md-3">
                        <p>
                            <label>Leguminosas:</label>
                            <input type="number" name="legumes" id="id_legumes" class="form-control" min="0" value="0">
                        </p>
                    </div>
                    <div class="col-md-3">
                        <p>
                            <label>Leche entera:</label>
                            <input type="number" name="whole_milk" id="id_whole_milk" class="form-control" min="0" value="0">
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3">
                        <p>
                            <label>Azucares s/g:</label>
                            <input type="number" name="sugars_s" id="id_sugars_s" class="form-control" min="0" value="0">
                        </p>
                    </div>
                    <div class="col-md-3">
                        <p>
                            <label>Azucares c/g:</label>
                            <input type="number" name="sugars_c" id="id_sugars_c" class="form-control" min="0" value="0">
                        </p>
                    </div>
                    <div class="col-md-3">
                        <p>
                            <label>Proteinas AOA mbg:</label>
                            <input type="number" name="protein_mbg" id="id_protein_mbg" class="form-control" min="0" value="0">
                        </p>
                    </div>
                    <div class="col-md-3">
                        <p>
                            <label>Proteinas AOA bg:</label>
                            <input type="number" name="protein_bg" id="id_protein_bg" class="form-control" min="0" value="0">
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3">
                        <p>
                            <label>Aceites y grasas s/p:</label>
                            <input type="number" name="oils_and_fats_s" id="id_oils_and_fats_s" class="form-control" min="0" value="0">
                        </p>
                    </div>
                    <div class="col-md-3">
                        <p>
                            <label>Aceites y grasas c/p:</label>
                            <input type="number" name="oils_and_fats_c" id="id_oils_and_fats_c" class="form-control" min="0" value="0">
                        </p>
                    </div>
                    <div class="col-md-3">
                        <p>
                            <label>Proteinas AOA mg:</label>
                            <input type="number" name="protein_mg" id="id_protein_mg" class="form-control" min="0" value="0">
                        </p>
                    </div>
                    <div class="col-md-3">
                        <p>
                            <label>Proteinas AOA ag:</label>
                            <input type="number" name="protein_ag" id="id_protein_ag" class="form-control"  min="0" value="0">
                        </p>
                    </div>
                </div>
                <div class="row mt-5">
                    <table style="width:80%">
                    <tr>
                        <td>
                            <p class="text-center">
                                <label>Kcal Carbohidratos</label>
                            </p>
                            <p class="text-center">
                                <label id="kcal_carbohidratos"></label>
                            </p>
                        </td>
                        <td>
                            <p class="text-center">
                                <label>Kcal Proteinas:</label>
                            </p>
                            <p class="text-center">
                                <label id="kcal_proteinas"></label>
                            </p>
                        </td>
                        <td>
                            <p class="text-center">
                                <label>Kcal Lipidos:</label>
                            </p>
                            <p class="text-center">
                                <label id="kcal_lipidos"></label>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <p class="text-center">
                                <label class="text-center">Distribucion Carbohidratos</label>
                            </p>
                            <p class="text-center">
                                <label id="distribucion_carbohidratos"></label>
                            </p>
                        </td>
                        <td>
                            <p class="text-center">
                                <label>Distribucion Proteinas:</label>
                            </p>
                            <p class="text-center">
                                <label id="distribucion_proteinas"></label>
                            </p>
                        </td>
                        <td>
                            <p class="text-center">
                                <label>Distribucion Lipidos:</label>
                            </p>
                            <p class="text-center">
                                <label id="distribucion_lipidos"></label>
                            </p>
                        </td>
                    </tr>
                    </table>
                    <div class="mt-5 ml-5">
                        <p class="text-center">
                            <label class="control-label h3">Kcal TOTAL:</label>
                        </p>
                        <p class="text-center h1">
                            <label id="kcal_total"></label>
                        </p>
                    </div>
                </div>
                <p></p><input type="submit" class="btn btn-primary btn-block" value="Agregar"></p>
                </form>
            </div>
        </div>
    </div>
</main>
<script>
    $(document).ready(function () {
        $('.select2').select2({
        theme:'bootstrap4'
        });
    });
    $(function(){
		$("input").change(function(){
            var totalg_carbohydrates = (Number($("#id_vegetables").val()) * 4) + (Number($("#id_fruits").val()) * 15) + 
                                    (Number($("#id_cereals_and_tubers_s").val()) * 15) + (Number($("#id_cereals_and_tubers_c").val()) * 15) + 
                                    (Number($("#id_legumes").val()) * 20) + (Number($("#id_protein_mbg").val()) * 0) + 
                                    (Number($("#id_protein_bg").val()) * 0) + (Number($("#id_protein_mg").val()) * 0) + 
                                    (Number($("#id_protein_ag").val()) * 0) + (Number($("#id_skim_milk").val()) * 12) + 
                                    (Number($("#id_low_fat_milk").val()) * 12) + (Number($("#id_whole_milk").val()) * 12) + 
                                    (Number($("#id_oils_and_fats_c").val()) * 3) + (Number($("#id_oils_and_fats_s").val()) * 0) + 
                                    (Number($("#id_sugars_c").val()) * 10) + (Number($("#id_sugars_s").val()) * 10);
            
            var totalg_protein = (Number($("#id_vegetables").val()) * 2) + (Number($("#id_fruits").val()) * 0) + 
                                    (Number($("#id_cereals_and_tubers_s").val()) * 2) + (Number($("#id_cereals_and_tubers_c").val()) * 2) + 
                                    (Number($("#id_legumes").val()) * 8) + (Number($("#id_protein_mbg").val()) * 7) + 
                                    (Number($("#id_protein_bg").val()) * 7) + (Number($("#id_protein_mg").val()) * 7) + 
                                    (Number($("#id_protein_ag").val()) * 7) + (Number($("#id_skim_milk").val()) * 9) + 
                                    (Number($("#id_low_fat_milk").val()) * 9) + (Number($("#id_whole_milk").val()) * 9) + 
                                    (Number($("#id_oils_and_fats_c").val()) * 3) + (Number($("#id_oils_and_fats_s").val()) * 0) + 
                                    (Number($("#id_sugars_c").val()) * 0) + (Number($("#id_sugars_s").val()) * 0);
            
            var totalg_lipids = (Number($("#id_vegetables").val()) * 0) + (Number($("#id_fruits").val()) * 0) + 
                                    (Number($("#id_cereals_and_tubers_s").val()) * 0) + (Number($("#id_cereals_and_tubers_c").val()) * 5) + 
                                    (Number($("#id_legumes").val()) * 1) + (Number($("#id_protein_mbg").val()) * 1) + 
                                    (Number($("#id_protein_bg").val()) * 3) + (Number($("#id_protein_mg").val()) * 5) + 
                                    (Number($("#id_protein_ag").val()) * 8) + (Number($("#id_skim_milk").val()) * 2) + 
                                    (Number($("#id_low_fat_milk").val()) * 4) + (Number($("#id_whole_milk").val()) * 8) + 
                                    (Number($("#id_oils_and_fats_c").val()) * 5) + (Number($("#id_oils_and_fats_s").val()) * 5) + 
                                    (Number($("#id_sugars_c").val()) * 5) + (Number($("#id_sugars_s").val()) * 0);

            var kcal_carbohidratos = totalg_carbohydrates * 4;
            var kcal_proteinas = totalg_protein * 4;
            var kcal_lipidos = totalg_lipids * 9;
            var kcal_total = kcal_carbohidratos + kcal_proteinas + kcal_lipidos;  

			if (totalg_carbohydrates){
				$("#kcal_carbohidratos").text(kcal_carbohidratos);
				$("#kcal_proteinas").text(kcal_proteinas);
				$("#kcal_lipidos").text(kcal_lipidos);
				$("#distribucion_carbohidratos").text(((kcal_carbohidratos*100)/kcal_total).toFixed(2));
				$("#distribucion_proteinas").text(((kcal_proteinas*100)/kcal_total).toFixed(2));
				$("#distribucion_lipidos").text(((kcal_lipidos*100)/kcal_total).toFixed(2));

				$("#kcal_total").text(kcal_carbohidratos + kcal_proteinas + kcal_lipidos);
			}
		});
	});
</script>
{% endblock %}